# 进度追踪系统使用指南

## 📊 功能概述

EyeCare Pro 的进度追踪系统使用浏览器本地存储（localStorage）记录您的所有训练数据，提供详细的性能分析和可视化图表。

---

## ✨ 主要功能

### 1. **自动记录训练数据**

每次训练游戏时，系统会自动记录：
- 训练时间戳
- 训练时长（秒）
- 得分
- 难度等级
- 准确率（%）
- 完成轮数
- 游戏特定数据（如对比度阈值、目标数量等）

**保存频率**：
- Gabor Patch: 每 20 轮保存一次
- MOT: 暂不自动保存（可手动实现）
- Contrast: 暂不自动保存（可手动实现）
- Vernier: 每 15 轮保存一次
- Crowding: 每 15 轮保存一次

### 2. **总体统计**

在 `/progress` 页面顶部显示四个关键指标：

- **总训练次数**：记录的训练会话总数
- **累计训练时长**：以小时为单位的总训练时间
- **平均准确率**：所有游戏的平均准确率
- **连续训练天数**：当前连续训练天数和历史最长连续天数

### 3. **每周活动热图**

显示过去 7 天的训练频率：
- 柱状图展示每天的训练次数
- 直观了解训练习惯
- 激励保持规律训练

### 4. **各游戏详细统计**

每个游戏独立显示：
- 训练次数
- 平均准确率
- **进步幅度**：对比最近 10 次和最早 10 次训练的准确率变化

### 5. **性能曲线图**

三条可视化曲线：

#### 准确率趋势（绿色）
- 显示最近 30 次训练的准确率变化
- 上升趋势表明学习效果
- 帮助识别是否达到高原期

#### 得分趋势（蓝色）
- 得分通常结合难度计算
- 高难度+高分=优秀表现

#### 难度进展（紫色）
- 追踪训练难度的提升
- 自适应算法会根据表现调整难度

---

## 🔧 数据管理

### 导出数据

1. 点击进度页面右上角的 **"导出数据"** 按钮
2. 下载 JSON 格式文件，文件名格式：`eyecare-training-YYYY-MM-DD.json`
3. 此文件包含：
   - 所有训练会话记录
   - 连续训练天数信息
   - 导出时间戳

**用途**：
- 备份训练数据
- 在不同设备间迁移数据
- 长期存档

### 导入数据

1. 点击 **"导入数据"** 按钮
2. 选择之前导出的 JSON 文件
3. 系统会合并或替换当前数据

⚠️ **注意**：导入会覆盖现有数据，请谨慎操作！

### 清除数据

点击 **"清除"** 按钮（红色）可删除所有本地训练数据。

⚠️ **警告**：此操作不可撤销！建议先导出备份。

---

## 📈 如何解读数据

### 准确率

- **< 60%**：需要降低难度或多练习
- **60-75%**：最佳学习区（挑战但不挫败）
- **> 85%**：可能难度太低，系统应自动提升

### 进步幅度

- **正值**：表示有改善（如 +15.3% 表示提升了 15.3%）
- **负值**：可能是难度增加或状态波动
- **接近 0**：达到稳定期或高原期

### 连续训练天数

- 每天至少完成一次训练即可保持连续
- 中断一天会重置为 1
- 长连续天数表明良好的训练习惯

---

## 💡 训练建议

### 基于数据的优化策略

1. **监控准确率**
   - 如果长期低于 65%，降低难度或换其他游戏
   - 如果长期高于 90%，增加挑战

2. **关注进步曲线**
   - 前 10-20 次训练通常进步最快
   - 20-40 次后可能进入高原期
   - 高原期建议：
     - 休息 2-3 天后再继续
     - 尝试不同的游戏
     - 增加训练强度

3. **保持训练规律**
   - 每周 3-5 次比每天长时间更有效
   - 每次 20-30 分钟最佳
   - 避免疲劳训练（准确率突降时停止）

4. **交叉训练**
   - 不要只玩一个游戏
   - 不同游戏训练不同的视觉能力
   - 推荐组合：
     - **基础组合**：Gabor + MOT
     - **高级组合**：Vernier + Crowding
     - **全面组合**：所有游戏轮换

---

## 🔒 隐私与数据安全

### 本地存储

- **所有数据仅存储在您的浏览器本地**
- 不会上传到任何服务器
- 不会与第三方共享

### 数据持久性

- 数据保存在 `localStorage` 中
- 除非清除浏览器数据或手动删除，否则永久保存
- 私密浏览模式下数据不会保存

### 跨设备同步

- 默认不支持云同步
- 需要手动导出/导入 JSON 文件
- 未来可能添加云备份功能（需登录）

---

## 🐛 故障排除

### 数据没有保存？

**可能原因**：
1. 浏览器隐私设置阻止了 localStorage
2. 使用私密/无痕模式
3. 训练轮数未达到自动保存阈值

**解决方案**：
1. 检查浏览器设置允许本地存储
2. 使用普通模式
3. 多玩几轮直到自动保存

### 图表显示异常？

**可能原因**：
1. 数据点太少（< 3 次训练）
2. 浏览器兼容性问题

**解决方案**：
1. 完成更多训练会话
2. 尝试现代浏览器（Chrome, Edge, Firefox）

### 导入数据失败？

**可能原因**：
1. JSON 文件格式错误
2. 文件损坏

**解决方案**：
1. 确保导入的是从本系统导出的 JSON 文件
2. 用文本编辑器检查 JSON 格式是否正确

---

## 📚 技术细节

### 数据结构

```typescript
// 单次训练会话
interface GameSession {
  gameType: 
    | 'gabor' 
    | 'mot' 
    | 'contrast' 
    | 'vernier' 
    | 'crowding'
    | 'visual-search'   // 🆕 视觉搜索
    | 'schulte'         // 🆕 舒尔特表格
    | 'change-detection'; // 🆕 变化盲视
  timestamp: number;        // Unix 时间戳
  duration: number;         // 秒
  score: number;           // 得分
  difficulty: number;      // 0-20
  accuracy: number;        // 0-100
  rounds: number;          // 完成轮数
  metadata?: {             // 游戏特定数据
    bestContrast?: number;
    targetCount?: number;
    mode?: string;         // 🆕 游戏模式
    gridSize?: number;     // 🆕 舒尔特表格大小
    mistakes?: number;     // 🆕 错误次数
    avgClickInterval?: number; // 🆕 平均点击间隔
    avgReactionTime?: number;  // 🆕 平均反应时间
    bestStreak?: number;   // 🆕 最佳连击
    [key: string]: any;
  };
}

// 连续训练记录
interface TrainingStreak {
  current: number;         // 当前连续天数
  longest: number;         // 历史最长
  lastTrainingDate: string; // YYYY-MM-DD
}
```

### 存储键名

- `eyecare_training_history`: 训练会话数组
- `eyecare_training_streak`: 连续训练记录
- `eyecare_user`: 用户信息
- `schulte-best-times`: 舒尔特表格最佳记录

### 限制

- 最多保存最近 **500 次**训练会话
- 超过后自动删除最早的记录
- 防止 localStorage 溢出（通常限制 5-10MB）

---

## 🎮 支持的游戏列表

| 游戏 | 类型 | 自动保存 | 特殊数据 |
|-----|-----|---------|---------|
| Gabor斑训练 | 视觉敏锐度 | ✅ 每20轮 | 对比度阈值 |
| 多目标追踪 | 注意力 | ✅ 每5轮 | 目标数量 |
| 对比敏感度 | 视觉敏锐度 | ✅ 每10轮 | 最佳对比度 |
| 游标视力 | 视觉敏锐度 | ✅ 每15轮 | - |
| 拥挤效应 | 知觉 | ✅ 每15轮 | - |
| 视觉搜索 🆕 | 注意力 | ✅ 每5轮 | 模式、反应时间、连击 |
| 舒尔特表格 🆕 | 注意力 | ✅ 每局 | 表格大小、模式、错误数 |
| 变化盲视 🆕 | 知觉 | ✅ 每5轮 | 难度模式、反应时间 |

---

## 🎯 未来计划

### 短期（已完成 ✅）

- [x] 为所有游戏添加自动保存
- [x] 新增3款观察力训练游戏
- [x] 移动端响应式适配
- [ ] 训练提醒通知
- [ ] 成就系统（徽章）

### 中期（已实现部分）

- [x] 用户账号系统
- [x] AI 个性化训练建议
- [x] 分享卡片生成
- [ ] 云备份功能
- [ ] 社交功能（排行榜）

### 长期（探索中）

- [ ] 与眼科医生共享数据
- [ ] 临床研究数据收集
- [ ] VR/AR 版本的进度追踪

---

## 📞 反馈与支持

如果您发现任何问题或有改进建议，欢迎：
1. 在 GitHub 仓库提交 Issue
2. 联系开发团队
3. 贡献代码（Pull Request）

**让我们一起改善视力训练体验！** 👁️✨
